function dragStartMouse(e){boardArea.mouseDown=!0;var r=getpositionmouse(e);boardArea.mouseDownX=r.x,boardArea.mouseDownY=r.y,boardArea.mouseX=r.x,boardArea.mouseY=r.y,boardArea.focus_page=getFocusPage(r),boardArea.currentStroke=new strokeList[boardArea.strokeType](resolvePosition(r))}function dragMouse(e){var r=getpositionmouse(e);if(boardArea.mouseX=r.x,boardArea.mouseY=r.y,boardArea.currentStroke){if(getFocusPage(r)!=boardArea.focus_page)return boardArea.currentStroke.stop(resolvePosition(r)),void dragStartMouse(e);boardArea.currentStroke.update(resolvePosition(r)),boardArea.clearTemp(),boardArea.currentStroke.render(boardArea.temp_context,0,yOffset())}}function dragStopMouse(e){boardArea.mouseDown=!1;var r=getpositionmouse(e);boardArea.mouseX=r.x,boardArea.mouseY=r.y,boardArea.currentStroke&&(boardArea.currentStroke.update(resolvePosition(r)),boardArea.clearTemp(),boardArea.currentStroke.render(boardArea.temp_context,0,yOffset()),boardArea.currentStroke.mouseLeave(resolvePosition(r)))}function dragStartTouch(e){boardArea.mouseDown=!0;var r=getpositiontouch(e);boardArea.mouseDownX=r.x,boardArea.mouseDownY=r.y,boardArea.mouseX=r.x,boardArea.mouseY=r.y,boardArea.focus_page=getFocusPage(r),boardArea.currentStroke=new strokeList[boardArea.strokeType](resolvePosition(r)),console.log("wazzap"),e.preventDefault()}function dragTouch(e){var r=getpositiontouch(e);if(boardArea.mouseX=r.x,boardArea.mouseY=r.y,boardArea.currentStroke){if(getFocusPage(r)!=boardArea.focus_page)return boardArea.currentStroke.stop(resolvePosition(r)),void dragStartMouse(e);boardArea.currentStroke.update(resolvePosition(r)),boardArea.clearTemp(),boardArea.currentStroke.render(boardArea.temp_context,0,yOffset())}e.preventDefault()}function dragStopTouch(e){boardArea.mouseDown=!1;var r={x:boardArea.mouseX,y:boardArea.mouseY};boardArea.currentStroke&&(boardArea.currentStroke.update(resolvePosition(r)),boardArea.clearTemp(),"PenStroke"!=boardArea.strokeType&&"Eraser"!=boardArea.strokeType||boardArea.currentStroke.optimize(),boardArea.currentStroke.render(boardArea.temp_context,0,yOffset()),boardArea.currentStroke.mouseLeave(resolvePosition(r))),e.preventDefault()}function setupListeners(){boardArea.temp_canvas.addEventListener("touchstart",dragStartTouch),boardArea.temp_canvas.addEventListener("touchend",dragStopTouch),boardArea.temp_canvas.addEventListener("touchmove",dragTouch),boardArea.temp_canvas.addEventListener("mousedown",dragStartMouse),boardArea.temp_canvas.addEventListener("mouseup",dragStopMouse),boardArea.temp_canvas.addEventListener("mouseleave",dragStopMouse),boardArea.temp_canvas.addEventListener("mousemove",dragMouse)}function getpositionmouse(e){return{x:Number((((e.clientX-boardArea.canvas.getBoundingClientRect().left)*boardArea.DPR-boardArea.margin_x)/boardArea.scale).toFixed(2)),y:Number((((e.clientY-boardArea.canvas.getBoundingClientRect().top)*boardArea.DPR-boardArea.margin_y)/boardArea.scale).toFixed(2))}}function getpositiontouch(e){if(e.touches&&1==e.touches.length)var r=e.touches[0],o=Number((((r.pageX-boardArea.canvas.getBoundingClientRect().left)*boardArea.DPR-boardArea.margin_x)/boardArea.scale).toFixed(2)),a=Number((((r.pageY-boardArea.canvas.getBoundingClientRect().top)*boardArea.DPR-boardArea.margin_y)/boardArea.scale).toFixed(2));return{x:o,y:a}}function getFocusPage(e){return e.y>(1-boardArea.page_extension)*resY?1:0}function yOffset(){return boardArea.focus_page?(1-boardArea.page_extension)*boardArea.height:-boardArea.page_extension*boardArea.height}function resolvePosition(e){return boardArea.focus_page?{x:e.x,y:e.y-(1-boardArea.page_extension)*resY}:{x:e.x,y:e.y+boardArea.page_extension*resY}}window.addEventListener("load",init),window.addEventListener("resize",boardArea.resize.bind(boardArea)),$(document).ready(function(){$(".stroke").click(function(){($(".stroke").removeClass("is-active"),$("#tmp_canvas").css("cursor","url(../static/css/dot.cur), auto"),$(this).addClass("is-active"),"Eraser"==boardArea.strokeType&&"PenStroke"==this.id)?(boardAttributes.width=boardAttributes.tempWidth,$(".size-selector").removeClass("is-active"),document.querySelectorAll(".size-selector").forEach(function(e){e.getAttribute("data-size")==boardAttributes.width.toString()&&e.classList.toggle("is-active")})):"Eraser"==this.id&&(boardAttributes.tempWidth=boardAttributes.width);boardArea.strokeType=this.id}),$(".color-selector").click(function(){var e=$(this).css("background-color");$(".color-selector").removeClass("is-active"),$(this).addClass("is-active"),boardAttributes.color=e}),$(".size-selector").click(function(){width=$(this).data().size,$(".size-selector").removeClass("is-active"),$(this).addClass("is-active"),"Eraser"==boardArea.strokeType&&(boardAttributes.tempWidth=boardAttributes.width,1==$(this).data("size")&&$("#tmp_canvas").css("cursor",'url("../static/css/cursor-size1.png") 13 13, auto'),"5"==$(this).data("size")&&$("#tmp_canvas").css("cursor",'url("../static/css/cursor-size2.png") 15 15, auto'),"16"==$(this).data("size")&&$("#tmp_canvas").css("cursor",'url("../static/css/cursor-size3.png") 20.5 20.5, auto'),"25"==$(this).data("size")&&$("#tmp_canvas").css("cursor",'url("../static/css/cursor.png") 23 23, auto')),boardAttributes.width=width}),$("#Eraser").click(function(){$("#tmp_canvas").css("cursor",'url("../static/css/cursor-size1.png") 13 13, auto')})}),$(document).on("load",function(){null!==localStorage.getItem("recoverLogin")&&($("#saveOnline").trigger("click"),console.log("work1"))});